å‹ã§çµã‚‹ã€<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒŠãƒ³ãƒãƒ¼ã‚º3äºˆæƒ³ã‚¢ãƒ—ãƒª</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; }
    button { padding: 1em 2em; font-size: 1.2em; margin: 0.5em; }
    #result { font-size: 2em; margin-top: 1em; color: #0077cc; }
  </style>
</head>
<body>
  <h1>ğŸ¯ ãƒŠãƒ³ãƒãƒ¼ã‚º3äºˆæƒ³ã‚¢ãƒ—ãƒª</h1>
  <h2>ğŸ“‚ éå»ã®å½“é¸ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€</h2>
  <input type="file" id="csvFile" accept=".csv,.txt">
  <button onclick="loadCSV()">èª­ã¿è¾¼ã‚€</button>
  <div id="csvOutput"></div>

  <p>ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãƒ©ãƒ³ãƒ€ãƒ ãª3æ¡ã®æ•°å­—ã‚’äºˆæƒ³ã—ã¾ã™ï¼</p>
  <button onclick="generatePrediction()">äºˆæƒ³ã™ã‚‹</button>
  <button onclick="generateSmartPrediction()">é »åº¦ã§äºˆæ¸¬ã™ã‚‹</button>
  <button onclick="drawFromPastData()">éå»ã‹ã‚‰æŠ½é¸ã™ã‚‹</button>
  <h3>ğŸ“Š é »åº¦ã‹ã‚‰å‹åˆ¥äºˆæ¸¬ï¼ˆæ–°è¦ç”Ÿæˆï¼‰</h3>
<button onclick="generatePatternOneEach()">å‡ºç¾ãƒ‘ã‚¿ãƒ¼ãƒ³å‹ã§äºˆæ¸¬ã™ã‚‹</button>
  <button onclick="generatePatternOneEach()">å‡ºç¾ãƒ‘ã‚¿ãƒ¼ãƒ³å‹ã§äºˆæ¸¬ã™ã‚‹</button>
<h3>ğŸ§© å‹ã‚’æŒ‡å®šã—ã¦éå»ã‹ã‚‰æŠ½é¸</h3>
<button onclick="drawFromPastByType('ãƒãƒ©ãƒãƒ©')">ãƒãƒ©ãƒãƒ©å‹ã‹ã‚‰æŠ½é¸</button>
<button onclick="drawFromPastByType('ãƒ€ãƒ–ãƒ«')">ãƒ€ãƒ–ãƒ«å‹ã‹ã‚‰æŠ½é¸</button>
<button onclick="drawFromPastByType('ã‚¾ãƒ­ç›®')">ã‚¾ãƒ­ç›®å‹ã‹ã‚‰æŠ½é¸</button>
  <h3>å‡ºç¾ãƒ‘ã‚¿ãƒ¼ãƒ³å‹ã®äºˆæ¸¬ï¼ˆ1ç¨®é¡ãšã¤ï¼‰</h3>
  <div id="patternBarabaraOne"></div>
  <div id="patternDoubleOne"></div>
  <div id="patternZoroOne"></div>

  <div id="result"></div>
<h3>ğŸ“Š å‹åˆ¥å‡ºç¾æ•°ã‚°ãƒ©ãƒ•</h3>
<canvas id="typeChart" width="400" height="300"></canvas>
<button onclick="showTypeDistribution()">å‹åˆ¥å‡ºç¾æ•°ã‚’ã‚°ãƒ©ãƒ•ã§è¡¨ç¤º</button>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script>
    function analyzeFrequency(data) {
      const freq = Array(10).fill(0);
      data.forEach(row => {
        const number = row.number;
        if (number && typeof number === "string") {
          number.split("").forEach(d => {
            const digit = parseInt(d);
            if (!isNaN(digit)) freq[digit]++;
          });
        }
      });
      return freq;
    }

    function generatePrediction() {
      const digits = [];
      for (let i = 0; i < 3; i++) {
        digits.push(Math.floor(Math.random() * 10));
      }
      document.getElementById("result").textContent = digits.join("");
    }
       function getNumberType(numStr) {
  const [a, b, c] = numStr.split("");
  if (a === b && b === c) return "ã‚¾ãƒ­ç›®";
  if (a === b || b === c || a === c) return "ãƒ€ãƒ–ãƒ«";
  return "ãƒãƒ©ãƒãƒ©";
}
function drawFromPastByType(type) {
  const rows = document.querySelectorAll("#csvOutput table tr");
  const numbers = [];

  rows.forEach((row, i) => {
    if (i === 0) return;
    const cells = row.querySelectorAll("td");
    const num = cells[1]?.textContent?.trim();
    if (/^\d{3}$/.test(num) && getNumberType(num) === type) {
      numbers.push(num);
    }
  });

  if (numbers.length === 0) {
    alert(`ã€Œ${type}å‹ã€ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ`);
    return;
  }

  const pick = numbers[Math.floor(Math.random() * numbers.length)];
  document.getElementById("result").textContent = `${type}å‹ã‹ã‚‰æŠ½é¸ï¼š${pick}`;
}
    function generateSmartPrediction() {
      const freqList = Array.from(document.querySelectorAll("#csvOutput ul li")).map(li => {
        const match = li.textContent.match(/(\d)ï¼š(\d+)å›/);
        return match ? { digit: parseInt(match[1]), count: parseInt(match[2]) } : null;
      }).filter(Boolean);

      if (freqList.length < 3) {
        alert("ååˆ†ãªé »åº¦ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }

      const sorted = freqList.sort((a, b) => b.count - a.count).slice(0, 3);
      const prediction = sorted.map(item => item.digit).join("");
      document.getElementById("result").textContent = prediction;
    }

    function drawFromPastData() {
      const rows = document.querySelectorAll("#csvOutput table tr");
      const numbers = [];

      rows.forEach((row, i) => {
        if (i === 0) return;
        const cells = row.querySelectorAll("td");
        const num = cells[1]?.textContent?.trim();
        if (/^\d{3}$/.test(num)) numbers.push(num);
      });

      if (numbers.length === 0) {
        alert("éå»ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“");
        return;
      }

      const randomPick = numbers[Math.floor(Math.random() * numbers.length)];
      document.getElementById("result").textContent = `éå»ã‹ã‚‰æŠ½é¸ï¼š${randomPick}`;
    }
function showTypeDistribution() {
  const rows = document.querySelectorAll("#csvOutput table tr");
  let counts = { ãƒãƒ©ãƒãƒ©: 0, ãƒ€ãƒ–ãƒ«: 0, ã‚¾ãƒ­ç›®: 0 };

  rows.forEach((row, i) => {
    if (i === 0) return;
    const cells = row.querySelectorAll("td");
    const num = cells[1]?.textContent?.trim();
    if (/^\d{3}$/.test(num)) {
      const type = getNumberType(num);
      counts[type]++;
    }
  });

  const ctx = document.getElementById("typeChart").getContext("2d");
  new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["ãƒãƒ©ãƒãƒ©å‹", "ãƒ€ãƒ–ãƒ«å‹", "ã‚¾ãƒ­ç›®å‹"],
      datasets: [{
        label: "å‡ºç¾æ•°",
        data: [counts["ãƒãƒ©ãƒãƒ©"], counts["ãƒ€ãƒ–ãƒ«"], counts["ã‚¾ãƒ­ç›®"]],
        backgroundColor: ["#4caf50", "#ff9800", "#f44336"]
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}
    function generatePatternOneEach() {
      const freqList = Array.from(document.querySelectorAll("#csvOutput ul li")).map(li => {
        const match = li.textContent.match(/(\d)ï¼š(\d+)å›/);
        return match ? { digit: parseInt(match[1]), count: parseInt(match[2]) } : null;
      }).filter(Boolean);

      if (freqList.length < 3) {
        alert("ååˆ†ãªé »åº¦ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ã€‚");
        return;
      }

      const sorted = freqList.sort((a, b) => b.count - a.count);
      const topDigits = sorted.slice(0, 6).map(item => item.digit);

      let barabara = null;
      for (let i = 0; i < topDigits.length; i++) {
        for (let j = 0; j < topDigits.length; j++) {
          for (let k = 0; k < topDigits.length; k++) {
            if (i !== j && j !== k && i !== k) {
              barabara = `${topDigits[i]}${topDigits[j]}${topDigits[k]}`;
              break;
            }
          }
          if (barabara) break;
        }
        if (barabara) break;
      }

      let double = null;
      for (let i = 0; i < topDigits.length; i++) {
        for (let j = 0; j < topDigits.length; j++) {
          if (topDigits[i] !== topDigits[j]) {
            double = `${topDigits[i]}${topDigits[i]}${topDigits[j]}`;
            break;
          }
        }
        if (double) break;
      }

      const zoro = `${topDigits[0]}${topDigits[0]}${topDigits[0]}`;

      document.getElementById("patternBarabaraOne").textContent = `ãƒãƒ©ãƒãƒ©å‹ï¼š${barabara}`;
      document.getElementById("patternDoubleOne").textContent = `ãƒ€ãƒ–ãƒ«å‹ï¼š${double}`;
      document.getElementById("patternZoroOne").textContent = `ã‚¾ãƒ­ç›®å‹ï¼š${zoro}`;
    }

    function loadCSV() {
      const fileInput = document.getElementById("csvFile");
      const file = fileInput.files[0];
      if (!file) {
        alert("CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");
        return;
      }

      Papa.parse(file, {
        header: false,
        skipEmptyLines: true,
        complete: function(results) {
          const rawData = results.data;
          const cleanData = [];

          let html = "<table border='1'><tr><th>æ—¥ä»˜</th><th>å½“é¸ç•ªå·</th></tr>";

          rawData.forEach((row, i) => {
            const values = row.map(v => v.trim());
            const date = values.find(v => /^\d{4}[-/]\d{1,2}[-/]\d{1,2}$/.test(v));
            const number = values.find(v => /^\d{3}$/.test(v));
            if (date && number) {
              html += `<tr><td>${date}</td><td>${number}</td></tr>`;
              cleanData.push({ date, number });
            } else {
              console.log(`ã‚¹ã‚­ãƒƒãƒ—ã•ã‚ŒãŸè¡Œ ${i}:`, row);
            }
          });

          html += "</table>";
          document.getElementById("csvOutput").innerHTML = html;

          const freq = analyzeFrequency(cleanData);
          let freqHtml = "<h3>æ•°å­—ã®å‡ºç¾é »åº¦</h3><ul>";
          freq.forEach((count, digit) => {
            freqHtml += `<li>${digit}ï¼š${count}å›</li>`;
          });
          freqHtml += "</ul>";
          document.getElementById("csvOutput").innerHTML += freqHtml;
        }
      });
    }
  </script>
</body>
</html>